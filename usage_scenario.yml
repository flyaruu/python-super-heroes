---
name: Superheroes k6 scenario
author: Frank Lyaruu
description: Superheroes (Rust) k6 load testing scenario )
compose-file: !include compose.yml
# services:
#     k6:
#       build: k6-image
#       environment:
#         K6_HOST: http://fights:8000 
#       command: ["bash", "-c", "while true; do sleep 3600; done"]
#       volumes:
#         - ./k6:/k6:ro
#         - ./k6/results:/results
flow:
  - name: K6 run 1 RPS
    container: k6
    commands:
      - type: console
#        command: k6 run -e RAMPING_RATE=1 --new-machine-readable-summary  --summary-export=/results/summary_1.json /k6/load.js
        command: k6 run -e RAMPING_RATE=1 --new-machine-readable-summary  --summary-export=/results/summary_1.json /k6/load.js && cat /results/summary_1.json
        note: Starting k6 Load Test 1 rps
        log-stdout: true
        read-notes-stdout: true
        read-sci-stdout: true
  - name: K6 run 10 RPS
    container: k6
    commands:
      - type: console
        command: k6 run -e RAMPING_RATE=10 --new-machine-readable-summary  --summary-export=/results/summary_10.json /k6/load.js && cat /results/summary_10.json
        note: Starting k6 Load Test 10 rps
        log-stdout: true
        read-notes-stdout: true
        read-sci-stdout: true
  - name: K6 run 50 RPS
    container: k6
    commands:
      - type: console
        command: k6 run -e RAMPING_RATE=50 --new-machine-readable-summary  --summary-export=/results/summary_50.json /k6/load.js && cat /results/summary_50.json
        note: Starting k6 Load Test 50 rps
        log-stdout: true
        read-notes-stdout: true
        read-sci-stdout: true
  - name: K6 run 75 RPS
    container: k6
    commands:
      - type: console
        command: k6 run -e RAMPING_RATE=75 --new-machine-readable-summary  --summary-export=/results/summary_75.json /k6/load.js && cat /results/summary_75.json
        note: Starting k6 Load Test 75 rps
        log-stdout: true
        read-notes-stdout: true
        read-sci-stdout: true             
  - name: K6 run 100 RPS
    container: k6
    commands:
      - type: console
        command: k6 run -e RAMPING_RATE=100 --new-machine-readable-summary  --summary-export=/results/summary_100.json /k6/load.js && cat /results/summary_100.json
        note: Starting k6 Load Test 100 rps
        log-stdout: true
        read-notes-stdout: true
        read-sci-stdout: true
